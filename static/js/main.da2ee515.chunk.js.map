{"version":3,"sources":["assets/img/selftoken_zoom_in.jpg","styles/Spinner.module.css","utils/getWeb3.js","components/Spinner.js","utils/sig2vrs.js","utils/api.js","utils/hexToEvenLengthHex.js","components/DelegatedTransferForm.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","spinner","getWeb3","Promise","resolve","reject","window","addEventListener","Object","asyncToGenerator","regenerator_default","a","mark","_callee","web3","_web","provider","_web2","wrap","_context","prev","next","ethereum","Web3","enable","t0","console","log","providers","HttpProvider","stop","this","Spinner","react_default","createElement","className","styles","Component","sig2vrs","sig","Error","stripped_sig","slice","length","v","r","s","api","url","data","succeed","failed","axios","post","then","result","code","alert","message","catch","error","hexToEvenLengthHex","hexStr","stripped","DelegatedTransferForm","state","recipient","amount","orderId","componentDidMount","_this$props","_this","props","queryParams","to","utils","isAddress","setState","warn","self","parseFloat","isNaN","handleAmountChange","value","handleRecipientChange","event","target","handleOrderIdChange","handleDelegatedTransferFormSubmit","_this$props2","accounts","delegatedTransferOperator","networkId","callback","delegatedTransferAmountBN","delegatedTransferAmountWeiBN","_operator","_to","_delegate","_value","_fee","_nonce","_userDataNumber","_userData","delegationHash","_signature","_vrs","_int_v","operator_address","tx_data","post_data","preventDefault","abrupt","BigNumber","times","_address","Math","floor","Date","now","numberToHex","soliditySha3","t","eth","sign","sent","parseInt","methods","transferPreSigned","encodeABI","version","delegatedTransferOperatorAddress","order","_id","onSubmit","id","htmlFor","type","onChange","placeholder","react_numeric_input_default","pattern","mobile","min","step","defaultProps","location","hostname","formatFromWeiBnToEtherStr","bn","decimals","arguments","undefined","div","toFormat","config","FORMAT","prefix","decimalSeparator","groupSeparator","groupSize","secondaryGroupSize","fractionGroupSeparator","fractionGroupSize","suffix","App","selfTokenContract","accountState","ethBalanceBN","selfBalanceBN","globalState","totalSupplyBN","queryString","isValidNetwork","search","qs","net","getId","SelfTokenJSON","networks","hasOwnProperty","Contract","abi","address","DelegatedTransferOperatorJSON","fetchGlobalState","getAccounts","poll","setInterval","_callee2","_context2","fetchAccountState","_callee3","totalSupplyStr","_context3","totalSupply","call","assign","_callee4","_this$state","getEthBalance","getSelfBalance","values","ethBalanceStr","selfBalanceStr","_context4","getBalance","balanceOf","all","_this$state2","src","selftokenIcon","style","height","components_DelegatedTransferForm","components_Spinner","Boolean","match","ReactDOM","render","HashRouter","Route","path","component","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.da2ee515.chunk.js","sourcesContent":["module.exports = \"data:image/jpeg;base64,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\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"spinner\":\"Spinner_spinner__KCoow\"};","import Web3 from \"web3\";\n\nconst getWeb3 = () =>\n  new Promise((resolve, reject) => {\n    // Wait for loading completion to avoid race conditions with web3 injection timing.\n    window.addEventListener(\"load\", async () => {\n      // Modern dapp browsers...\n      if (window.ethereum) {\n        const web3 = new Web3(window.ethereum);\n        try {\n          // Request account access if needed\n          await window.ethereum.enable();\n          // Acccounts now exposed\n          resolve(web3);\n        } catch (error) {\n          reject(error);\n        }\n      }\n      // Legacy dapp browsers...\n      else if (window.web3) {\n        // Use Mist/MetaMask's provider.\n        const web3 = window.web3;\n        console.log(\"Injected web3 detected.\");\n        resolve(web3);\n      }\n      // Fallback to localhost; use dev console port by default...\n      else {\n        const provider = new Web3.providers.HttpProvider(\n          \"https://rinkeby.infura.io\"\n        );\n        const web3 = new Web3(provider);\n        console.log(\"No web3 instance injected, using Local web3.\");\n        resolve(web3);\n      }\n    });\n  });\n\nexport default getWeb3;\n","import React, { Component } from \"react\";\n\nimport styles from \"styles/Spinner.module.css\";\n\nclass Spinner extends Component {\n  render() {\n    return <div className={styles.spinner}></div>;\n  }\n}\n\nexport default Spinner;\n","// return vrs object\n// v: hex string\n// r: hex string\n// s: hex string\nconst sig2vrs = (sig) => {\n  if (typeof sig !== 'string') {\n    throw new Error(\"in sig2vrs, signature must be type 'string', is currently type \" + (typeof sig) + \".\");\n  }\n\n  const stripped_sig = (sig.slice(0, 2) === '0x') ? sig.slice(2) : sig;\n\n  if (stripped_sig.length !== 130) {\n    throw new Error(\"sig length not 130 or 132 in sig2vrs\");\n  }\n\n  const vrs = {\n    v: \"0x\" + stripped_sig.slice(128, 130),\n    r: \"0x\" + stripped_sig.slice(0, 64),\n    s: \"0x\" + stripped_sig.slice(64, 128),\n  }\n\n  return vrs;\n};\n\nexport default sig2vrs;\n","import axios from 'axios';\n\nfunction api(url, data, succeed, failed) {\n    axios.post(url, data).then(function (result) {\n        if (result.data.code === 0) return succeed? succeed(result.data.data): true;\n        if (failed) return failed(result);\n        alert(result.data.message);\n        return false;\n    }).catch(function (error) {\n        if (failed) return failed(error);\n        alert(error);\n        return false;\n    });\n}\n\n// function get(key, value) {\n//     if (!localStorage[key]) localStorage[key] = JSON.stringify(value);\n//     return JSON.parse(localStorage[key]);\n// }\n\n// function set(key, value) {\n//     localStorage[key] = JSON.stringify(value);\n// }\n\n// function dict(arr, key = '_id') {\n//     var o = {};\n//     for (var i in arr) o[arr[i][key]] = arr[i];\n//     return o;\n// }\n\nexport default api;","\nconst hexToEvenLengthHex = (hexStr) => {\n  if (typeof hexStr !== 'string') {\n    throw new Error(\"Error in hexToEvenLengthHex, hexStr must be type 'string', is currently type \" + (typeof hexStr) + \".\");\n  }\n\n  const stripped = (hexStr.slice(0, 2) === '0x') ? hexStr.slice(2) : hexStr;\n  return (stripped.length % 2 === 0) ? ('0x' + stripped) : ('0x0' + stripped);\n};\n\nexport default hexToEvenLengthHex;\n","import React, { Component } from \"react\";\nimport PropTypes from 'prop-types';\nimport { BigNumber } from 'bignumber.js'; // not web3.utils.BN\nimport NumericInput from 'react-numeric-input';\n\nimport sig2vrs from \"utils/sig2vrs\";\nimport api from \"utils/api\";\nimport hexToEvenLengthHex from \"utils/hexToEvenLengthHex\";\n\n// import styles from \"../styles/DelegatedTransferForm.module.css\";\n\nclass DelegatedTransferForm extends Component {\n  state = {\n    recipient: \"\",\n    amount: 100, // SELF\n    orderId: 0,\n    // fee: 1,\n  };\n\n  componentDidMount = () => {\n    const { queryParams, web3 } = this.props;\n    console.log(\"DelegatedTransferForm queryParams\", queryParams);\n\n    if (!!queryParams.to) {\n      if (web3.utils.isAddress(queryParams.to)) {\n        console.log(\"DelegatedTransferForm: queryParams.to correctly parsed\");\n        this.setState({\n          recipient: queryParams.to,\n        })\n      } else {\n        console.warn(\"DelegatedTransferForm: queryParams.to is provided but not an address\");\n      }\n    }\n\n    if (!!queryParams.self) {\n      const amount = parseFloat(queryParams.self);\n      if (!isNaN(amount)) {\n        console.log(\"DelegatedTransferForm: amount parsed, get\", amount);\n        this.setState({\n          amount: amount,\n        })\n      } else {\n        console.warn(\"DelegatedTransferForm: queryParams.amount is provided but parseFloat returns NaN.\");\n      }\n    }\n  }\n\n  handleAmountChange = (value) => {\n    this.setState({\n      amount: value,\n    });\n  }\n\n  handleRecipientChange = (event) => {\n    this.setState({\n      recipient: event.target.value,\n    });\n  }\n\n  handleOrderIdChange = (value) => {\n    this.setState({\n      orderId: value,\n    });\n  }\n\n  handleDelegatedTransferFormSubmit = async (event) => {\n    event.preventDefault();\n\n    const { web3, accounts, delegatedTransferOperator, networkId, callback } = this.props;\n\n    if (accounts.length === 0) {\n      alert(\"No account injected form dapp browser.\\nPlease unlock your account in MetaMask or the DApp browser.\");\n      return;\n    }\n\n    // check address and amount\n    const recipient = this.state.recipient; // string\n    const amount = this.state.amount; // number\n    console.log(\"recipient\", recipient);\n    console.log(\"amount\", amount);\n\n    if (!web3.utils.isAddress(recipient)) {\n      alert(\"The recipient address is not valid.\");\n      return;\n    }\n\n    let delegatedTransferAmountBN = new BigNumber(amount);\n    let delegatedTransferAmountWeiBN = delegatedTransferAmountBN.times(1e18);\n\n    const _operator = delegatedTransferOperator._address;\n    const _to = recipient;\n    // TODO: use server's wallet address\n    const _delegate = \"0x0000000000000000000000000000000000000000\";\n    const _value = delegatedTransferAmountWeiBN;\n    const _fee = 0;\n    const _nonce = Math.floor(Date.now() / 1000);\n    const _userDataNumber = this.state.orderId;\n    // the length of _userDataHex may be odd or even, but it must be even in soliditySha3\n    // const _userDataHex = web3.utils.numberToHex(_userDataNumber);\n    const _userData = hexToEvenLengthHex(web3.utils.numberToHex(_userDataNumber));\n    console.log(\"_userData\", _userData);\n\n    // delegationHash is a 32-byte (\"0x\" + 64 chars) hex string.\n    const delegationHash = web3.utils.soliditySha3(\n      {t: \"address\", v: _operator},\n      {t: \"address\", v: _to},\n      {t: \"address\", v: _delegate},\n      {t: \"uint256\", v: _value},\n      {t: \"uint256\", v: _fee},\n      {t: \"uint256\", v: _nonce},\n      {t: \"bytes\", v: _userData},\n    );\n    console.log(\"delegationHash\", delegationHash);\n\n    // delegationSignature is a 65-byte (\"0x\" + 130 chars) hex string.\n    const _signature = await web3.eth.sign(delegationHash, accounts[0]);\n    const _vrs = sig2vrs(_signature);\n    const _int_v = parseInt(_vrs.v);\n\n    if (_int_v !== 27 && _int_v !== 28) {\n      throw new Error(\"_vrs.v not 27 or 28\");\n    }\n\n    const version = 1;\n    const operator_address = delegatedTransferOperator._address;\n    console.log(\"operator_address\", operator_address);\n\n    const tx_data = delegatedTransferOperator.methods.transferPreSigned(\n      _to,\n      _delegate,\n      _value,\n      _fee,\n      _nonce,\n      _userData,\n      // _signature\n      _vrs.r,\n      _vrs.s,\n      _vrs.v\n    // );\n    ).encodeABI();\n    console.log(\"tx_data\", tx_data);\n\n    const post_data = {\n      networkId,\n      version,\n      delegatedTransferOperatorAddress: delegatedTransferOperator._address,\n      tx_data,\n    }\n\n    const delegatedTransfer_api_url = \"http://test.selftoken.co:8080/v1/delegatedTransfer\";\n    api(delegatedTransfer_api_url, post_data, (order) => {\n      // if transaction is broadcasted\n      // data is order\n      console.log(\"order\", order);\n      alert(\"交易已發送！\\n取貨單號：\" + order._id);\n      callback();\n    }, error => {\n      // if failed\n      console.error(\"error\", error);\n    });\n\n    // axios.post(delegatedTransfer_api_url, post_data)\n    // .then((response) => {\n    //   console.log(response);\n    // })\n    // .catch((error) => {\n    //   console.log(error);\n    // });\n\n    // .estimateGas({\n    //   from: accounts[0],\n    //   gas: 150000,\n    // }).then((gasAmount) => {\n    //   console.log(\"estimateGas gasAmount\", gasAmount);\n    // })\n    // .catch((error) => {\n    //   // revert or throw or any error\n    //   console.error(\"estimateGas error\", error);\n    // });\n\n\n    // delegatedTransferOperator.methods.transferPreSigned(\n    //   _to,\n    //   _delegate,\n    //   _value,\n    //   _fee,\n    //   _nonce,\n    //   _userData,\n    //   // _signature\n    //   _vrs.r,\n    //   _vrs.s,\n    //   _vrs.v\n    // )\n    // .send({\n    //   from: accounts[0],\n    // })\n    // .once('transactionHash', (hash) => {\n    //   console.log('once transactionHash', hash);\n    // })\n    // .once('error', (error) => {\n    //   console.log('once error', error);\n    // })\n    // .then((receipt) => {\n    //   // will be fired once the receipt is mined\n    //   console.log(\"then receipt\", receipt);\n    //   callback();\n    // });\n  }\n\n  render() {\n    return (\n      <form\n        onSubmit={this.handleDelegatedTransferFormSubmit}\n        id=\"transfer-form\"\n        className=\"transfer-form\"\n      >\n        <div className=\"form-group\">\n          <label htmlFor=\"delegatedTransferRecipientInput\">\n            Recipient\n          </label>\n\n          <input\n            type=\"text\"\n            className=\" address-input address-text\"\n            id=\"delegatedTransferRecipientInput\"\n            value={this.state.recipient}\n            onChange={this.handleRecipientChange}\n            placeholder=\"0x0000000000000000000000000000000000000000\"\n          />\n        </div>\n\n        <div className=\"form-group\">\n          <div className=\"text-center mb-3\">\n            <label htmlFor=\"transferAmount\">Token Amount (SELF)</label>\n            <NumericInput\n              id=\"transferAmount\"\n              type=\"number\"\n              pattern=\"\\d*\"\n              mobile\n              className=\"numeric-input\"\n              min={0}\n              step={10}\n              value={this.state.amount}\n              onChange={this.handleAmountChange}\n            />\n          </div>\n        </div>\n{/*\n        <div className=\"form-group\">\n          <div className=\"text-center mb-3\">\n            <label htmlFor=\"orderId\">Order ID</label>\n            <NumericInput\n              id=\"orderId\"\n              mobile\n              className=\"numeric-input\"\n              min={0}\n              step={1}\n              value={this.state.orderId}\n              onChange={this.handleOrderIdChange}\n            />\n          </div>\n        </div> */}\n\n        <div className=\"text-center\">\n          <button type=\"submit\" className=\"solid-rectangle-button\">\n            {/* <span>Send</span> */}\n            <span>Delegated Transfer</span>\n          </button>\n        </div>\n      </form>\n    );\n  }\n}\n\nDelegatedTransferForm.propTypes = {\n  web3: PropTypes.object,\n  accounts: PropTypes.array,\n  delegatedTransferOperator: PropTypes.object,\n  networkId: PropTypes.number,\n  callback: PropTypes.func,\n};\n\nDelegatedTransferForm.defaultProps = {\n  web3: {},\n  accounts: [],\n  delegatedTransferOperator: {},\n  networkId: 1,\n  callback: () => {},\n};\n\nexport default DelegatedTransferForm;\n","import React, { Component } from \"react\";\nimport { Route, Link } from \"react-router-dom\";\nimport * as qs from \"query-string\";\nimport { BigNumber } from 'bignumber.js'; // not web3.utils.BN in 1.0.0-beta.34\n\nimport SelfTokenJSON from \"./contracts/SelfToken.json\";\nimport DelegatedTransferOperatorJSON from \"./contracts/DelegatedTransferOperatorV4.json\";\nimport getWeb3 from \"./utils/getWeb3\";\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport \"./styles/AddressInput.css\";\nimport \"./styles/NumericInput.css\";\nimport \"./App.css\";\n\nimport selftokenIcon from \"./assets/img/selftoken_zoom_in.jpg\";\n\nimport Spinner from \"./components/Spinner.js\";\nimport DelegatedTransferForm from \"./components/DelegatedTransferForm.js\";\n// import ERC20TransferForm from \"./components/ERC20TransferForm.js\";\n\n// const BN = require('bn.js'); // used in web3\n\n\nif (window.location.hostname === \"localhost\" || window.location.hostname === \"127.0.0.1\") {\n} else {\n  // console.log will not work in production\n  console.log = () => {};\n}\n\nconst fmt = {\n  prefix: '',\n  decimalSeparator: '.',\n  groupSeparator: ',',\n  groupSize: 3,\n  secondaryGroupSize: 0,\n  fractionGroupSeparator: ' ',\n  fractionGroupSize: 0,\n  suffix: ''\n}\nBigNumber.config({ FORMAT: fmt });\n\nfunction formatFromWeiBnToEtherStr(bn, decimals=4) {\n  return bn.div(1e18).toFormat(decimals);\n}\n\nclass App extends Component {\n  state = {\n    web3: null,\n    networkId: 0,\n    selfTokenContract: null,\n    accounts: null,\n    accountState: {\n      ethBalanceBN: new BigNumber(0),\n      selfBalanceBN: new BigNumber(0),\n    },\n    globalState: {\n      totalSupplyBN: new BigNumber(0),\n    },\n    queryParams: {},\n  };\n\n  componentDidMount = async () => {\n    try {\n      const queryString = this.props.location.search; // \"?xxx\"\n      const queryParams = qs.parse(queryString); // object with strings\n      this.setState({\n        queryParams,\n      });\n\n      // Get network provider and web3 instance.\n      const web3 = await getWeb3();\n\n      // Get the networkId and check if on valid network.\n      const networkId = await web3.eth.net.getId(); // Number\n      const isValidNetwork = SelfTokenJSON.networks.hasOwnProperty(networkId); // bool\n\n      this.setState({\n        web3,\n        networkId,\n        isValidNetwork,\n      });\n\n      // If not on valid network, stop here.\n      if (!isValidNetwork) {\n        return;\n      }\n\n      // Init contract instance.\n      const selfTokenContract = new web3.eth.Contract(\n        SelfTokenJSON.abi,\n        SelfTokenJSON.networks[networkId].address\n      );\n\n      const delegatedTransferOperator = new web3.eth.Contract(\n        DelegatedTransferOperatorJSON.abi,\n        DelegatedTransferOperatorJSON.networks[networkId].address\n      );\n\n      this.setState({\n        selfTokenContract,\n        delegatedTransferOperator,\n      }, () => {\n        // fetch global state\n        this.fetchGlobalState();\n      });\n\n      // Use web3 to get the user's accounts.\n      const accounts = await web3.eth.getAccounts();\n\n      await this.setState({\n        accounts\n      }, () => {\n        // fetch user state\n      });\n\n      this.poll();\n      setInterval(() => {\n        this.poll();\n      }, 10000);\n      // this.fetchAccountState();\n    } catch (error) {\n      // Catch any errors for any of the above operations.\n      // Should never go here.\n      alert(\n        `Failed to load web3, accounts, or contract. Check console for details.`\n      );\n      console.error(error);\n    }\n  };\n\n  poll = async () => {\n    console.log(\"poll\");\n\n    // this.fetchGlobalState();\n    this.fetchAccountState();\n  }\n\n  fetchGlobalState = async () => {\n    console.log(\"fetchGlobalState\");\n\n    const { selfTokenContract } = this.state;\n\n    // If contract is not ready, return.\n    if (!selfTokenContract) {\n      return;\n    }\n\n    // Get total supply\n    const totalSupplyStr = await selfTokenContract.methods.totalSupply().call();\n    const totalSupplyBN = new BigNumber(totalSupplyStr);\n\n    // Make a clone of globalState.\n    const globalState = Object.assign({}, this.state.globalState);\n    globalState.totalSupplyBN = totalSupplyBN\n\n    // Update state with the result.\n    this.setState({ globalState });\n  };\n\n  fetchAccountState = async () => {\n    console.log(\"fetchAccountState\");\n\n    const { web3, accounts, selfTokenContract } = this.state;\n\n    // If there are no accounts injected, return.\n    if (accounts.length === 0) {\n      return;\n    }\n\n    // promises\n    const getEthBalance = web3.eth.getBalance(accounts[0]);\n    const getSelfBalance = selfTokenContract.methods.balanceOf(accounts[0]).call();\n    const values = await Promise.all([getEthBalance, getSelfBalance]);\n    const ethBalanceStr = values[0];\n    const selfBalanceStr = values[1];\n    console.log(\"ethBalanceStr\", ethBalanceStr);\n    console.log(\"selfBalanceStr\", selfBalanceStr);\n\n\n    // Make a clone of accountState.\n    let accountState = Object.assign({}, this.state.accountState);\n    accountState.ethBalanceBN = new BigNumber(ethBalanceStr);\n    accountState.selfBalanceBN = new BigNumber(selfBalanceStr);\n\n    // // Get ETH Balance\n    // const ethBalanceStr = await web3.eth.getBalance(accounts[0]);\n    // const ethBalanceBN = new BigNumber(ethBalanceStr);\n\n    // // Get SELF balance\n    // const balanceStr = await selfTokenContract.methods.balanceOf(accounts[0]).call();\n    // const balanceBN = new BigNumber(balanceStr);\n\n    // Update state with the result.\n    this.setState({ accountState });\n  };\n\n  render() {\n    const { web3, accounts, delegatedTransferOperator, networkId, queryParams } = this.state;\n\n    // If web3 is not initialized, then the website should still be loading.\n    if (!this.state.web3) {\n      return <Spinner/>;\n    }\n\n    // If not on a valid testnet, ask the user to change the network.\n    if (!this.state.isValidNetwork) {\n      return <div className=\"alert alert-danger\">Not on a valid Ethereum network. Please change the network to mainnet in MetaMask or your dapp browser.</div>;\n    }\n\n    return (\n      <div className=\"App\">\n\n        <div className=\"container\">\n\n          {/* Show warning message if the user or the developer is on testnet. */}\n          {(this.state.isValidNetwork && this.state.networkId !== 1) && (<div>\n            <div className=\"alert alert-warning\">You are on testnet. Please switch to Mainnet in MetaMask or your dapp browser.</div>\n          </div>)}\n\n          {/* <div>Total Supply: {formatFromWeiBnToEtherStr(this.state.globalState.totalSupplyBN)} SELF</div> */}\n\n          <div className=\"mt-3 mb-3 text-center\">\n            <h3>You have</h3>\n            <h3><i className=\"fab fa-ethereum\"></i> {formatFromWeiBnToEtherStr(this.state.accountState.ethBalanceBN, 4)} ETH</h3>\n            <h3>\n              <img src={selftokenIcon} style={{height: \"1em\"}}/>\n              <span>{formatFromWeiBnToEtherStr(this.state.accountState.selfBalanceBN, 1)} SELF</span>\n            </h3>\n          </div>\n\n          {/* <div className=\"text-center mb-5\">\n            <ERC20TransferForm\n              web3={web3}\n              accounts={accounts}\n              selfTokenContract={selfTokenContract}\n              callback={this.fetchAccountState}\n            />\n          </div> */}\n\n          <div className=\"text-center mb-5\">\n            <DelegatedTransferForm\n              web3={web3}\n              accounts={accounts}\n              delegatedTransferOperator={delegatedTransferOperator}\n              networkId={networkId}\n              queryParams={queryParams}\n              callback={this.fetchAccountState}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { HashRouter as Router, Route } from 'react-router-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <Router>\n    <Route path=\"/\" component={App} />\n    {/* <App /> */}\n  </Router>\n, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}